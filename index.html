<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂêÉ‰ªÄÈ∫ºÈ∫ª‰ªîÂè∞ - Â∞èÁë™Ëéâ</title>
    <style>
        :root {
            --gold: #ffd700;
            --red: #ff3e3e;
            --bg: #1a1a1a;
            --panel: #333;
            --led-off: #444;
            --led-on: #ffff00;
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 10px;
            user-select: none;
        }

        /* È†ÇÈÉ® LED È°ØÁ§∫Ëû¢Âπï */
        .header-display {
            display: flex;
            gap: 20px;
            margin-bottom: 10px;
            background: #000;
            padding: 10px 20px;
            border: 3px solid #555;
            border-radius: 5px;
        }

        .led-box {
            text-align: center;
        }
        .led-label { font-size: 12px; color: #aaa; }
        .led-num { font-size: 24px; color: var(--red); font-weight: bold; text-shadow: 0 0 5px var(--red); }

        /* ‰∏ªÊ©üÂè∞ 24 Ê†º (7x5 ‰ΩàÂ±Ä) */
        .machine-main {
            display: grid;
            grid-template-columns: repeat(7, 50px);
            grid-template-rows: repeat(5, 50px);
            gap: 5px;
            background: #222;
            padding: 10px;
            border: 10px solid #555;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,1);
        }

        .slot {
            background: var(--led-off);
            border-radius: 3px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            border: 2px solid #000;
            transition: 0.05s;
        }

        .slot.active {
            background: var(--led-on);
            box-shadow: 0 0 15px var(--led-on);
            color: black;
            transform: scale(1.1);
            z-index: 2;
        }

        .slot-food { font-size: 9px; margin-top: 2px; text-align: center; overflow: hidden; height: 12px;}

        /* ‰∏≠ÈñìÂ§ß Logo */
        .center-logo {
            grid-column: 2 / 7;
            grid-row: 2 / 5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #444;
            border-radius: 5px;
            border: 2px inset #222;
        }

        .center-logo h1 { color: var(--gold); font-size: 20px; margin: 0; text-shadow: 2px 2px #000; }
        .center-logo .mode-text { font-size: 14px; margin-top: 5px; color: #fff; }

        /* ‰∏ãÊñπÊäºÊ≥®ÂçÄ */
        .bet-panel {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            margin-top: 15px;
            width: 380px;
        }

        .bet-btn {
            background: #444;
            border: 2px solid #666;
            color: white;
            padding: 5px 0;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }

        .bet-btn:active { transform: translateY(2px); }
        .bet-icon { font-size: 20px; }
        .bet-count { color: var(--gold); font-size: 14px; font-weight: bold; }

        /* ÊéßÂà∂ÊåâÈàï */
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 20px;
        }

        .btn-go {
            width: 80px;
            height: 80px;
            background: radial-gradient(#ff4d4d, #b30000);
            border-radius: 50%;
            border: 5px solid white;
            color: white;
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 10px rgba(0,0,0,0.5);
        }

        .btn-go:disabled { background: #777; cursor: not-allowed; }

        /* Ë®≠ÂÆöÂçÄÂ°ä */
        .settings-toggle { margin-top: 15px; font-size: 12px; text-decoration: underline; cursor: pointer; color: #888; }
        .settings-content { display: none; margin-top: 10px; width: 350px; background: #333; padding: 10px; border-radius: 5px;}
        textarea { width: 100%; height: 80px; background: #000; color: #0f0; border: 1px solid #555; font-size: 12px;}

    </style>
</head>
<body>

    <div class="header-display">
        <div class="led-box">
            <div class="led-label">CREDIT</div>
            <div class="led-num" id="creditDisplay">100</div>
        </div>
        <div class="led-box" style="width: 120px;">
            <div class="led-label">TODAY'S CHOICE</div>
            <div class="led-num" id="todayResult" style="color: #0f0; font-size: 18px;">---</div>
        </div>
        <div class="led-box">
            <div class="led-label">WIN</div>
            <div class="led-num" id="winDisplay">0</div>
        </div>
    </div>

    <!-- 24 Ê†ºËµ∞È¶¨Ááà -->
    <div class="machine-main" id="machineGrid">
        <div class="center-logo">
            <h1 id="modeTitle">Â∞èÁë™ËéâÂêÉ‰ªÄÈ∫º</h1>
            <div class="mode-text">
                <button onclick="switchMode('out')">Â§ñÂá∫</button>
                <button onclick="switchMode('home')">Âú®ÂÆ∂</button>
            </div>
        </div>
        <!-- Ê†ºÂ≠êÁî± JS ÁîüÊàê -->
    </div>

    <!-- ‰∏ãÊñπ 12 ÊäºÊ≥®ÂçÄ -->
    <div class="bet-panel" id="betPanel">
        <!-- Áî± JS ÁîüÊàê -->
    </div>

    <div class="controls">
        <button class="btn-go" id="goBtn" onclick="spin()">GO!</button>
        <button onclick="clearBets()" style="background:#555; color:#fff; border:none; border-radius:5px; padding:0 10px;">Ê∏ÖÈô§ÊäºÊ≥®</button>
    </div>

    <div class="settings-toggle" onclick="document.getElementById('settings').style.display='block'">‚öôÔ∏è Á∑®ËºØÈ£üÁâ©ÂÖßÂÆπ</div>
    <div class="settings-content" id="settings">
        <p style="margin:0 0 5px; font-size:12px;">Ëº∏ÂÖ•È£üÁâ©Ê∏ÖÂñÆÔºàÊØèË°å‰∏ÄÂÄãÔºåÂ∞çÊáâ‰∏ãÊñπÂúñÁ§∫È†ÜÂ∫èÔºâÔºö</p>
        <textarea id="foodInput"></textarea>
        <button onclick="saveFood()" style="width:100%; margin-top:5px;">ÂÑ≤Â≠òÊõ¥Êñ∞</button>
    </div>

    <script>
        // Á∂ìÂÖ∏ÂúñÁ§∫ (8Á®ÆÂü∫Á§é)
        const iconLib = ["üçé", "üçä", "ü•≠", "üîî", "üçâ", "‚≠ê", "7Ô∏è‚É£", "üç´"];
        const multiplier = { "üçé": 2, "üçä": 5, "ü•≠": 10, "üîî": 10, "üçâ": 20, "‚≠ê": 30, "7Ô∏è‚É£": 50, "üç´": 100 };
        
        // 24 Ê†ºÁöÑË∑ØÂæëÂ∞çÊáâÂúñÁ§∫ (Ê®°Êì¨ÁúüÂØ¶È∫ª‰ªîÂè∞ÂàÜ‰Ωà)
        const gridIcons = [
            "üçé", "üçä", "ü•≠", "üçé", "üîî", "üçâ", "üçé",
            "7Ô∏è‚É£", "üçé", "‚≠ê", "üçé", "üç´", "üçé", "ü•≠",
            "üçé", "üîî", "üçé", "üçâ", "üçé", "‚≠ê", "üçé", "7Ô∏è‚É£", "üçé", "ü•≠"
        ];
        
        // 24 Ê†ºÂú® 7x5 Á∂≤Ê†º‰∏≠ÁöÑÂ∫ßÊ®ô (È†ÜÊôÇÈáùÁπûÂúà)
        const gridPath = [
            0, 1, 2, 3, 4, 5, 6, // ‰∏äÊéí
            13, 20, 27, 34,      // Âè≥Êéí
            33, 32, 31, 30, 29, 28, // ‰∏ãÊéí
            21, 14, 7            // Â∑¶Êéí
        ];
        // Ë£úÈΩäÂâ©È§òÊ†ºÂ≠êÁöÑË∑ØÂæëÈ†ÜÂ∫è
        const pathIndices = [0,1,2,3,4,5,6,13,20,27,34,33,32,31,30,29,28,21,14,7]; 
        // ‰øÆÊ≠£: 7x5 È†ÜÂ∫èÁÇ∫: 
        const realPath = [0,1,2,3,4,5,6,13,20,27,34,33,32,31,30,29,28,21,14,7]; // ÈÄôÈÇäÁÇ∫‰∫ÜÁ§∫ÁØÑÁ∞°ÂåñÁÇ∫20Ê†º

        let foodData = {
            out: ["ÊãâÈ∫µ", "Êª∑ËÇâÈ£Ø", "Áæ©Â§ßÂà©È∫µ", "ÁÅ´Èçã", "Â£ΩÂè∏", "Êº¢Â†°", "ÁÇ∏Èõû", "ÁâõÊéí"],
            home: ["ÁÖÆÊ≥°È∫µ", "Ê∞¥È§É", "ÁÇíÈ£Ø", "Â§ñÈÄÅ", "ÂêêÂè∏", "‰πæÊãåÈ∫µ", "Á®ÄÈ£Ø", "Ê∞¥Êûú"]
        };
        
        let currentMode = 'out';
        let credit = 100;
        let bets = {};
        let isSpinning = false;

        function init() {
            renderMachine();
            renderBetPanel();
            updateDisplay();
        }

        function renderMachine() {
            const grid = document.getElementById('machineGrid');
            // Ê∏ÖÈô§ÁèæÊúâ slot
            document.querySelectorAll('.slot').forEach(s => s.remove());

            // ÁúüÂØ¶ 24 Ê†ºÁπûÂúàÈ†ÜÂ∫èÂ∫ßÊ®ô (7x5)
            // 0 1 2 3 4 5 6
            // 7           13
            // 14          20
            // 21          27
            // 28 29 30 31 32 33 34
            const path = [0,1,2,3,4,5,6,13,20,27,34,33,32,31,30,29,28,21,14,7]; 
            
            path.forEach((gridPos, i) => {
                const slot = document.createElement('div');
                slot.className = 'slot';
                slot.id = `path-${i}`;
                slot.style.gridColumn = (gridPos % 7) + 1;
                slot.style.gridRow = Math.floor(gridPos / 7) + 1;
                
                const icon = gridIcons[i % gridIcons.length];
                const food = foodData[currentMode][iconLib.indexOf(icon)] || "???";
                
                slot.innerHTML = `<div>${icon}</div><div class="slot-food">${food}</div>`;
                grid.appendChild(slot);
            });
            document.getElementById('foodInput').value = foodData[currentMode].join('\n');
        }

        function renderBetPanel() {
            const panel = document.getElementById('betPanel');
            panel.innerHTML = "";
            iconLib.forEach(icon => {
                const btn = document.createElement('div');
                btn.className = 'bet-btn';
                btn.onclick = () => addBet(icon);
                btn.innerHTML = `
                    <div class="bet-icon">${icon}</div>
                    <div class="bet-count" id="bet-${icon}">0</div>
                    <div style="font-size:10px; color:#666;">x${multiplier[icon]}</div>
                `;
                panel.appendChild(btn);
                bets[icon] = 0;
            });
        }

        function addBet(icon) {
            if (isSpinning || credit <= 0) return;
            bets[icon]++;
            credit--;
            updateDisplay();
            document.getElementById(`bet-${icon}`).innerText = bets[icon];
        }

        function clearBets() {
            if (isSpinning) return;
            iconLib.forEach(icon => {
                credit += bets[icon];
                bets[icon] = 0;
                document.getElementById(`bet-${icon}`).innerText = 0;
            });
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('creditDisplay').innerText = credit;
        }

        function switchMode(mode) {
            if (isSpinning) return;
            currentMode = mode;
            document.getElementById('modeTitle').innerText = mode === 'out' ? "Â§ñÂá∫ÂéªÂêÉ" : "Âú®ÂÆ∂Ë£°ÂêÉ";
            renderMachine();
        }

        function saveFood() {
            const lines = document.getElementById('foodInput').value.split('\n').map(s => s.trim());
            foodData[currentMode] = lines;
            renderMachine();
            document.getElementById('settings').style.display = 'none';
        }

        function spin() {
            if (isSpinning) return;
            // Ê™¢Êü•ÊòØÂê¶ÊúâÊäºÊ≥® (ÈÅ∏Â°´ÔºåÊ≤íÊäºÊ≥®‰πüËÉΩÁé©)
            
            isSpinning = true;
            document.getElementById('goBtn').disabled = true;
            document.getElementById('todayResult').innerText = "???";
            document.getElementById('winDisplay').innerText = 0;

            let currentIdx = 0;
            let totalSteps = 40 + Math.floor(Math.random() * 20);
            let speed = 50;

            const run = () => {
                document.querySelectorAll('.slot').forEach(s => s.classList.remove('active'));
                const activeSlot = document.getElementById(`path-${currentIdx % 20}`);
                activeSlot.classList.add('active');

                currentIdx++;
                if (currentIdx < totalSteps) {
                    if (currentIdx > totalSteps - 10) speed += 40;
                    setTimeout(run, speed);
                } else {
                    stopGame(currentIdx - 1);
                }
            };
            run();
        }

        function stopGame(finalIdx) {
            isSpinning = false;
            document.getElementById('goBtn').disabled = false;
            
            const idx = finalIdx % 20;
            const icon = gridIcons[idx % gridIcons.length];
            const food = foodData[currentMode][iconLib.indexOf(icon)] || "Èö®‰æøÂêÉ";

            document.getElementById('todayResult').innerText = food;

            // ÁµêÁÆó‰∏≠Áçé
            if (bets[icon] > 0) {
                const winAmount = bets[icon] * multiplier[icon];
                document.getElementById('winDisplay').innerText = winAmount;
                credit += winAmount;
                updateDisplay();
                alert(`ÊÅ≠ÂñúÔºÅÊäΩ‰∏≠ ${food}ÔºÅÁç≤Âæó ${winAmount} ÂàÜÔºÅ`);
            }
            
            // Ê∏ÖÈô§ÊäºÊ≥®Ê∫ñÂÇô‰∏ã‰∏ÄÊää (ÂèØ‰∏çÊ∏ÖÈô§)
            // iconLib.forEach(i => { bets[i] = 0; document.getElementById(`bet-${i}`).innerText = 0; });
        }

        init();
    </script>
</body>
</html>